<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Room with Model and Dynamic Cursor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            cursor: none;
        }
        canvas { display: block; }
        .overlay {
            position: fixed;
            color: white;
            font-family: Arial, sans-serif;
            font-size: 24px;
            padding: 10px;
        }
        #title { top: 10%; left: 50%; transform: translateX(-50%); }
        #ig { top: 10%; right: 10%; }
        #animation { top: 10%; left: 10%; }
        #art { bottom: 10%; left: 10%; }
        #contact { bottom: 10%; right: 10%; }
        #custom-cursor {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            width: 32px;
            height: 32px;
            background-image: url('cursor1.png');
            background-size: contain;
            background-repeat: no-repeat;
            transform-origin: center;
            transition: transform 0.05s ease-out;
        }
    </style>
</head>
<body>
    <div id="custom-cursor"></div>
    <div id="title" class="overlay">maks rz</div>
    <div id="ig" class="overlay">ig</div>
    <div id="animation" class="overlay">animation</div>
    <div id="art" class="overlay">art</div>
    <div id="contact" class="overlay">contact</div>
    <script>
        let scene, camera, renderer, room, model, targetPosition;
        const GRID_SIZE = 8;
        const STEP_SIZE = 1;

        // Cursor variables
        const cursor = document.getElementById('custom-cursor');
        let lastX = 0;
        let lastY = 0;
        let lastTimestamp = 0;

        function init() {
            // ... (previous init code remains unchanged)

            document.addEventListener('mousemove', onMouseMove);
            animate();
        }

        function onMouseMove(event) {
            const mouseX = Math.round((event.clientX / window.innerWidth - 0.5) * GRID_SIZE);
            const mouseY = Math.round((event.clientY / window.innerHeight - 0.5) * GRID_SIZE);

            targetPosition.x = mouseX * STEP_SIZE;
            targetPosition.z = mouseY * STEP_SIZE;

            // Update cursor
            updateCursor(event);
        }

        function updateCursor(event) {
            const currentTime = Date.now();
            const deltaTime = currentTime - lastTimestamp;
            
            if (deltaTime > 0) {
                const speedX = Math.abs(event.clientX - lastX) / deltaTime;
                const speedY = Math.abs(event.clientY - lastY) / deltaTime;
                const speed = Math.sqrt(speedX * speedX + speedY * speedY);

                const angle = Math.atan2(event.clientY - lastY, event.clientX - lastX);
                const squashFactor = 1 + speed * 0.1;
                const stretchFactor = 1 / squashFactor;

                cursor.style.transform = `translate(${event.clientX}px, ${event.clientY}px) 
                                          rotate(${angle}rad) 
                                          scale(${stretchFactor}, ${squashFactor})`;

                lastX = event.clientX;
                lastY = event.clientY;
                lastTimestamp = currentTime;
            }
        }

        function animate() {
            requestAnimationFrame(animate);

            // ... (previous animation code remains unchanged)

            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        init();
    </script>
</body>
</html>
